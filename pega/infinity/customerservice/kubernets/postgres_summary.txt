/* kubectl exec -ti hello-node-7579565d66-ctm5v -- bash */

/* kubectl apply -f postgres.yml */
/* kubectl logs postgres */
Error: Database is uninitialized and superuser password is not specified.
       You must specify POSTGRES_PASSWORD to a non-empty value for the
       superuser. For example, "-e POSTGRES_PASSWORD=password" on "docker run".

       You may also use "POSTGRES_HOST_AUTH_METHOD=trust" to allow all
       connections without a password. This is *not* recommended.

       See PostgreSQL documentation about "trust":
       https://www.postgresql.org/docs/current/auth-trust.html

/* kubectl apply -f postgres.yml */
The Pod "postgres" is invalid: spec: Forbidden: pod updates may not change fields other than `spec.containers[*].image`,`spec.initContainers[*].image`,`spec.activeDeadlineSeconds`,`spec.tolerations` (only additions to existing tolerations),`spec.terminationGracePeriodSeconds` (allow it to be set to 1 if it was previously negative)
  core.PodSpec{
        Volumes:        {{Name: "kube-api-access-m4zjm", VolumeSource: {Projected: &{Sources: {{ServiceAccountToken: &{ExpirationSeconds: 3607, Path: "token"}}, {ConfigMap: &{LocalObjectReference: {Name: "kube-root-ca.crt"}, Items: {{Key: "ca.crt", Path: "ca.crt"}}}}, {DownwardAPI: &{Items: {{Path: "namespace", FieldRef: &{APIVersion: "v1", FieldPath: "metadata.namespace"}}}}}}, DefaultMode: &420}}}},
        InitContainers: nil,
        Containers: []core.Container{
                {
                        ... // 5 identical fields
                        Ports:        nil,
                        EnvFrom:      nil,
-                       Env:          nil,
+                       Env:          []core.EnvVar{{Name: "POSTGRES_PASSWORD", Value: "postgres"}},
                        Resources:    {Limits: {s"cpu": {i: {...}, s: "500m", Format: "DecimalSI"}, s"memory": {i: {...}, Format: "BinarySI"}}, Requests: {s"cpu": {i: {...}, s: "500m", Format: "DecimalSI"}, s"memory": {i: {...}, Format: "BinarySI"}}},
                        ResizePolicy: nil,
                        ... // 13 identical fields
                },
        },
        EphemeralContainers: nil,
        RestartPolicy:       "Always",
        ... // 28 identical fields
  }
/* kubectl delete pod postgres */
pod "postgres" deleted

/* kubectl apply -f postgres.yml */
/* kubect logs postgres */
The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "en_US.utf8".
The default database encoding has accordingly been set to "UTF8".
The default text search configuration will be set to "english".

Data page checksums are disabled.

fixing permissions on existing directory /var/lib/postgresql/data ... ok
creating subdirectories ... ok
selecting dynamic shared memory implementation ... posix
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting default time zone ... Etc/UTC
creating configuration files ... ok
running bootstrap script ... ok
performing post-bootstrap initialization ... ok
initdb: warning: enabling "trust" authentication for local connections
initdb: hint: You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next time you run initdb.
syncing data to disk ... ok


Success. You can now start the database server using:

    pg_ctl -D /var/lib/postgresql/data -l logfile start

waiting for server to start....2023-10-01 17:32:37.275 UTC [48] LOG:  starting PostgreSQL 16.0 (Debian 16.0-1.pgdg120+1) on aarch64-unknown-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2023-10-01 17:32:37.276 UTC [48] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-10-01 17:32:37.278 UTC [51] LOG:  database system was shut down at 2023-10-01 17:32:37 UTC
2023-10-01 17:32:37.281 UTC [48] LOG:  database system is ready to accept connections
 done
server started

/usr/local/bin/docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*

2023-10-01 17:32:37.394 UTC [48] LOG:  received fast shutdown request
waiting for server to shut down....2023-10-01 17:32:37.395 UTC [48] LOG:  aborting any active transactions
2023-10-01 17:32:37.396 UTC [48] LOG:  background worker "logical replication launcher" (PID 54) exited with exit code 1
2023-10-01 17:32:37.397 UTC [49] LOG:  shutting down
2023-10-01 17:32:37.398 UTC [49] LOG:  checkpoint starting: shutdown immediate
2023-10-01 17:32:37.402 UTC [49] LOG:  checkpoint complete: wrote 3 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.002 s, sync=0.001 s, total=0.005 s; sync files=2, longest=0.001 s, average=0.001 s; distance=0 kB, estimate=0 kB; lsn=0/14EAA50, redo lsn=0/14EAA50
2023-10-01 17:32:37.404 UTC [48] LOG:  database system is shut down
 done
server stopped

PostgreSQL init process complete; ready for start up.

2023-10-01 17:32:37.512 UTC [1] LOG:  starting PostgreSQL 16.0 (Debian 16.0-1.pgdg120+1) on aarch64-unknown-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit
2023-10-01 17:32:37.513 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
2023-10-01 17:32:37.513 UTC [1] LOG:  listening on IPv6 address "::", port 5432
2023-10-01 17:32:37.514 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2023-10-01 17:32:37.517 UTC [62] LOG:  database system was shut down at 2023-10-01 17:32:37 UTC
2023-10-01 17:32:37.520 UTC [1] LOG:  database system is ready to accept connections
